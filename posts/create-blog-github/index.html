<!DOCTYPE html>
<html lang="ko-kr">
<head>
    <meta name="google-site-verification" content="iGuwne5LJzJBBoCxsCg4BhAYCzXlzuvrOufVjQCreyA" />
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>&gt; /tmp</title>
    
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="robots" content="all,follow">
    <meta name="googlebot" content="index,follow,snippet,archive">
    <link rel="stylesheet" href="https://jiwonaid.github.io/hugo-theme-console/css/terminal-0.7.1.min.css">
    <link rel="stylesheet" href="https://jiwonaid.github.io/hugo-theme-console/css/animate-3.7.2.min.css">
    <link rel="stylesheet" href="https://jiwonaid.github.io/hugo-theme-console/css/console.css">
    
      <!--[if lt IE 9]>
          <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
          <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
      <![endif]-->
       <meta property="og:title" content="Create a Blog with Github Pages and Actions" />
<meta property="og:description" content="" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://jiwonaid.github.io/posts/create-blog-github/" /><meta property="article:published_time" content="2021-09-18T17:16:24+09:00" />



<meta name="twitter:title" content="Create a Blog with Github Pages and Actions"/>
<meta name="twitter:description" content="부제: 깃헙 블로그를 깃헙 액션으로 배포하는 방법 개발자는 블로그를 시작했다! 효과는 미미했다.. Note: 본 문서는 이미 깃헙 페이지로 블로그를 제작한 사람을 대상으로 합니다. 개발자라면 기술 블로그 하나쯤 있어야 하기에 열심히 정적 사이트 생성기를 고르고 나면 배포부터 귀찮아지는 당신을 위한 Github Actions 안내서
Github Actions 처음 블로그를 생성하고 배포를 여러 번 반복하다 보면 이내 자동화에 대한 욕구가 샘솟게 됩니다.
물론 가장 직관적인 방법은 휴먼 오퍼레이터나 크론잡을 사용하는 것입니다.
혹시 더 좋은 방법(무료)은 없을까에 대해 고민하다 보면 이내 배포를 위한 compute 리소스가 필요하다는 것을 알게 됩니다."/>

</head>
<body class="terminal">
    <div class="container">
        <div class="terminal-nav" onclick="focusTerminal()">
          <header class="terminal-logo">
            <div class="logo terminal-prompt">
              
              
              <a href="https://jiwonaid.github.io/" class="no-style ">&gt; /tmp</a>:/<spam id="path"><a href='https://jiwonaid.github.io/posts'>posts</a>/<a href='https://jiwonaid.github.io/posts/create-blog-github'>create-blog-github</a>/</spam>$
              <input id="input" autofocus style="color: transparent; text-shadow: 0 0 0 black;"></div></header>
          <nav class="terminal-menu">
            <ul vocab="https://schema.org/" typeof="BreadcrumbList">
                
            </ul>
          </nav>
        </div>
        <p id="output">Supported commands: ls, cd ${PATH}</p>
    </div>

    <div class="container " >
        
<h1>Create a Blog with Github Pages and Actions</h1>

Sep. 18, 2021


<br/><br/>
<h2 id="부제-깃헙-블로그를-깃헙-액션으로-배포하는-방법">부제: 깃헙 블로그를 깃헙 액션으로 배포하는 방법</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-markdown" data-lang="markdown">개발자는 블로그를 시작했다!
효과는 미미했다..

Note: 본 문서는 이미 깃헙 페이지로 블로그를 제작한 사람을 대상으로 합니다.
</code></pre></div><p>개발자라면 기술 블로그 하나쯤 있어야 하기에 열심히 <a href="https://jamstack.org/generators/">정적 사이트 생성기</a>를 고르고 나면 배포부터 귀찮아지는 당신을 위한 Github Actions 안내서</p>
<h3 id="github-actions">Github Actions</h3>
<p>처음 블로그를 생성하고 배포를 여러 번 반복하다 보면 이내 자동화에 대한 욕구가 샘솟게 됩니다.</p>
<p>물론 가장 직관적인 방법은 휴먼 오퍼레이터나 크론잡을 사용하는 것입니다.</p>
<p>혹시 더 좋은 방법(무료)은 없을까에 대해 고민하다 보면 이내 배포를 위한 compute 리소스가 필요하다는 것을 알게 됩니다.</p>
<p>고려해 볼 수 있는 무료 리소스는 다음과 같습니다.</p>
<ul>
<li>
<p>개인 컴퓨터</p>
</li>
<li>
<p>오라클의 평생 무료 VM</p>
</li>
<li>
<p>Github Actions</p>
</li>
</ul>
<p>이 중 개인 컴퓨터와 오라클 VM은 조금 번거롭기에 Github Actions에 대해서 알아보겠습니다.</p>
<ol>
<li>
<p>무료인가요?</p>
<p>네 지금은 그렇습니다.</p>
<p>Github Actions는 현재 퍼블릭 repository나 직접 구성한 compute 리소스(runner)에서 무료로 사용할 수 있고, 그 이외에는 한 달에 500 MB의 storage와 2,000 분을 제공하고 있습니다.</p>
<p>참고: <a href="https://docs.github.com/en/billing/managing-billing-for-github-actions/about-billing-for-github-actions">https://docs.github.com/en/billing/managing-billing-for-github-actions/about-billing-for-github-actions</a></p>
</li>
<li>
<p>깃헙 이벤트를 받을 수 있나요?</p>
<p>repository의 Actions 탭에서 샘플 액션을 생성하고 main.yml의 윗부분을 보면 다음과 같습니다.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#75715e"># Controls when the workflow will run</span>
<span style="color:#f92672">on</span>:
  <span style="color:#75715e"># Triggers the workflow on push or pull request events but only for the master branch</span>
  <span style="color:#f92672">push</span>:
    <span style="color:#f92672">branches</span>: [ <span style="color:#ae81ff">master ]</span>
  <span style="color:#f92672">pull_request</span>:
    <span style="color:#f92672">branches</span>: [ <span style="color:#ae81ff">master ]</span>

  <span style="color:#75715e"># Allows you to run this workflow manually from the Actions tab</span>
  <span style="color:#f92672">workflow_dispatch</span>:
</code></pre></div><p>음 척 보니 push와 pull_request에 master라고 쓰여있습니다. master 브랜치에 작업을 하면 이 워크플로우(main.yml)가 동작하겠군요. 심플합니다.</p>
</li>
<li>
<p>커스텀 작업(사이트 빌드)이 가능한가요?</p>
<p>repository의 Actions 탭에서 샘플 액션을 생성하고 main.yml의 아랫부분을 보면 다음과 같습니다.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#75715e"># A workflow run is made up of one or more jobs that can run sequentially or in parallel</span>
<span style="color:#f92672">jobs</span>:
  <span style="color:#75715e"># This workflow contains a single job called &#34;build&#34;</span>
  <span style="color:#f92672">build</span>:
    <span style="color:#75715e"># The type of runner that the job will run on</span>
    <span style="color:#f92672">runs-on</span>: <span style="color:#ae81ff">ubuntu-latest</span>

    <span style="color:#75715e"># Steps represent a sequence of tasks that will be executed as part of the job</span>
    <span style="color:#f92672">steps</span>:
      <span style="color:#75715e"># Checks-out your repository under $GITHUB_WORKSPACE, so your job can access it</span>
      - <span style="color:#f92672">uses</span>: <span style="color:#ae81ff">actions/checkout@v2</span>

      <span style="color:#75715e"># Runs a single command using the runners shell</span>
      - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">Run a one-line script</span>
        <span style="color:#f92672">run</span>: <span style="color:#ae81ff">echo Hello, world!</span>

      <span style="color:#75715e"># Runs a set of commands using the runners shell</span>
      - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">Run a multi-line script</span>
        <span style="color:#f92672">run</span>: |<span style="color:#e6db74">
</span><span style="color:#e6db74">          echo Add other actions to build,
</span><span style="color:#e6db74">          echo test, and deploy your project.</span>          
</code></pre></div><p>runs-on에서 ubuntu-latest 지정하고, steps에서 repo를 checkout(actions/checkout@v2)하고 명령(run)들을 넣으면 동작하는군!</p>
<p>여기서 보이는 바와 같이 사용자는 두 가지 방법으로 원하는 동작을 수행 시킬 수 있습니다.</p>
<ol>
<li>
<p>사전에 정의된 actions를 사용한다.</p>
<p>예) actions/checkout@v2을 사용하면 repo를 가져옴</p>
</li>
<li>
<p>run으로 runs-on(ubuntu-latest) 위에서 쉘 스크립트 명령을 수행한다.</p>
<p>예) run: echo Hello, world!</p>
</li>
</ol>
<p>두 가지 방법 다 좋지만, 사이트 배포는 간단한 작업이고 이미 만들어져 있는 action을 사용하면 해당 action의 동작을 파악해야 하는 번거로움이 있어서 저는 run으로 작업했습니다.</p>
</li>
</ol>
<h3 id="hugo-site-cicd-with-github-actions">Hugo Site CI/CD with Github Actions</h3>
<p>아래 코드는 A repo(action이 설정된 hugo repo)에서 B repo(Github Pages repo)로 Hugo Site를 커밋하는 예제 코드입니다.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#f92672">name</span>: <span style="color:#ae81ff">Hugo site CI/CD</span>

<span style="color:#75715e"># Controls when the workflow will run</span>
<span style="color:#f92672">on</span>:
  <span style="color:#75715e"># Triggers the workflow on push or pull request events but only for the master branch</span>
  <span style="color:#f92672">push</span>:
    <span style="color:#f92672">branches</span>: [ <span style="color:#ae81ff">master ]</span>
  <span style="color:#f92672">pull_request</span>:
    <span style="color:#f92672">branches</span>: [ <span style="color:#ae81ff">master ]</span>

  <span style="color:#75715e"># Allows you to run this workflow manually from the Actions tab</span>
  <span style="color:#f92672">workflow_dispatch</span>:

<span style="color:#75715e"># A workflow run is made up of one or more jobs that can run sequentially or in parallel</span>
<span style="color:#f92672">jobs</span>:
  <span style="color:#75715e"># This workflow contains a single job called &#34;build-and-deploy&#34;</span>
  <span style="color:#f92672">build-and-deploy</span>:
    <span style="color:#75715e"># The type of runner that the job will run on</span>
    <span style="color:#f92672">runs-on</span>: <span style="color:#ae81ff">ubuntu-latest</span>

    <span style="color:#75715e"># Steps represent a sequence of tasks that will be executed as part of the job</span>
    <span style="color:#f92672">steps</span>:
      <span style="color:#75715e"># Checks-out your repository under $GITHUB_WORKSPACE, so your job can access it</span>
      - <span style="color:#f92672">uses</span>: <span style="color:#ae81ff">actions/checkout@v2</span>

      <span style="color:#75715e"># Runs a set of commands using the runners shell</span>
      - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">Build the site in the gohugoio/hugo:latest container</span>
        <span style="color:#f92672">run</span>: |<span style="color:#e6db74">
</span><span style="color:#e6db74">          git submodule init ${{ github.workspace }}
</span><span style="color:#e6db74">          git submodule update ${{ github.workspace }}
</span><span style="color:#e6db74">
</span><span style="color:#e6db74">          docker run \
</span><span style="color:#e6db74">          -v ${{ github.workspace }}:/src -v ${{ github.workspace }}/_site:/src/public \
</span><span style="color:#e6db74">          klakegg/hugo:0.83.1-busybox
</span><span style="color:#e6db74">
</span><span style="color:#e6db74">          sudo chmod -R 777 ${{ github.workspace }}/_site</span>          

      - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">Deploy the site to the target repo</span>
        <span style="color:#f92672">run</span>: |<span style="color:#e6db74">
</span><span style="color:#e6db74">          git clone https://github.com/jiwonaid/jiwonaid.github.io.git
</span><span style="color:#e6db74">          cp -r jiwonaid.github.io/.git ${{ github.workspace }}/_site
</span><span style="color:#e6db74">
</span><span style="color:#e6db74">          cd ${{ github.workspace }}/_site
</span><span style="color:#e6db74">
</span><span style="color:#e6db74">          git config --global user.email &#34;jiwonaid0@gmail.com&#34;
</span><span style="color:#e6db74">          git config --global user.name &#34;jiwonaid&#34;
</span><span style="color:#e6db74">          git remote set-url origin https://jiwonaid:${TOKEN}@github.com/jiwonaid/jiwonaid.github.io.git
</span><span style="color:#e6db74">
</span><span style="color:#e6db74">          git add *
</span><span style="color:#e6db74">          git commit -m &#34;$(date +%s)&#34;
</span><span style="color:#e6db74">          git push origin</span>          
</code></pre></div>


        <div class="footer">
    Powered by <a href="https://gohugo.io/">Hugo</a>.
</div>

    </div>
  </body>
  <script>
    var input = document.getElementById("input");
    input.style.width = "1ch";

    input.blur();
    function focusTerminal() {
      input.focus();
    }

    input.addEventListener('input', function () {
      input.style.width = input.value.length + 1 + "ch";
    });

    input.addEventListener('keydown', function () {
      if (event.key == 'Enter') {
        if (input.value == "ls") {
          var path = document.getElementById("path");
          var output = document.getElementById("output");
          var text = ".\n..\n";

          if ( path.innerText == "") {
            text += "about\nposts";
          }
          else if (path.innerText == "posts/") {
            text += "";
            text = text.replace(/\/posts\//g, "");
            text = text.replace(/\//g, "\n");
          }

          input.value = "";
          input.style.width = "1ch";
          output.innerText = text;
        }
        else if (input.value.substr(0, 3) == "cd ") {
          var text = input.value;
          text = text.replace("cd ", "");
          window.location.href = text;
        }
      }
    });
  </script>
</html>
